{% load static %}
<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
	<!-- Mobile Specific Meta -->
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!-- Favicon-->
	<link rel="shortcut icon" href="{% static 'img/logo2.png' %}">
	<!-- Author Meta -->
	<meta name="author" content="CodePixar">
	<!-- Meta Description -->
	<meta name="description" content="">
	<!-- Meta Keyword -->
	<meta name="keywords" content="">
	<!-- meta character set -->
	<meta charset="UTF-8">
	<!-- Site Title -->
	<title>Baka Store</title>

	<!--
            CSS
            ============================================= -->
	<link rel="stylesheet" href="{% static 'css/linearicons.css' %}">
	<link rel="stylesheet" href="{% static 'css/owl.carousel.css' %}">
	<link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/themify-icons.css' %}">
	<link rel="stylesheet" href="{% static 'css/nice-select.css' %}">
	<link rel="stylesheet" href="{% static 'css/nouislider.min.css' %}">
	<link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
	<link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css">
	<style>
        .single-product img {
            width: 100%;
            height: 350px; 
            object-fit: cover;
        }
		.about-us-widget {
			position: relative;
			z-index: 1;
			background: rgba(255, 255, 255, 0.108); 
			padding: 20px;
			border-radius: 10px;
		}
		
		.about-us-widget::before,
		.about-us-widget::after {
			content: '';
			position: absolute;
			z-index: -1;
			background-size: cover;
			background-position: center;
			width: 100px;
			height: 100px;
		}
		
		.about-us-widget::before {
			background-image: url('{% static "img/pngegg.png" %}'); 
			top: -20px;
			left: -20px;
		}
		
		.about-us-widget::after {
			background-image: url('{% static "img/naruto.png" %}'); 
			bottom: -20px;
			right: -20px;
		}
		
		.about-us-widget::before,
		.about-us-widget::after {
			opacity: 0.3; 
			transform: rotate(-15deg); 
			border-radius: 50%; 
		}

        .otaku-profile-area {
            background: #f9f9f9;
            padding: 2rem 0;
            font-family: 'Roboto', sans-serif;
        }
        
        .otaku-menu {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .otaku-menu .menu-header {
            margin-bottom: 2rem;
        }
        
        .otaku-menu .menu-logo {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin-bottom: 1rem;
        }
        
        .otaku-menu h3 {
            color: #333;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .otaku-nav {
            list-style: none;
            padding: 0;
        }
        
        .otaku-nav li {
            margin-bottom: 1rem;
        }
        
        .otaku-nav li a {
            text-decoration: none;
            font-size: 1rem;
            color: #555;
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background 0.3s;
        }
        
        .otaku-nav li a .icon {
            margin-right: 0.5rem;
            font-size: 1.2rem;
        }
        
        .otaku-nav li.active a,
        .otaku-nav li a:hover {
            background: #ffdd57;
            color: #fff;
        }

        .wallet-dashboard {
            background-color: #f8f9fa;
            border-radius: 15px;
        }
        
        .wallet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .wallet-balance {
            text-align: right;
        }
        
        .balance-label {
            display: block;
            font-size: 0.9rem;
            color: #6c757d;
        }
        
        .balance-amount {
            font-size: 2rem;
            font-weight: bold;
            color: #28a745;
        }
        
        .action-card {
            height: 100%;
        }
        
        .transaction-history {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .transaction-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .transaction-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
        }
        
        .transaction-details {
            flex-grow: 1;
        }
        
        .transaction-type {
            font-weight: bold;
            display: block;
        }
        
        .transaction-date {
            font-size: 0.8rem;
            color: #6c757d;
        }
        
        .transaction-amount {
            font-weight: bold;
        }
        
        .credit .transaction-amount {
            color: #28a745;
        }
        
        .debit .transaction-amount {
            color: #dc3545;
        }
        
        .empty-transactions {
            text-align: center;
            padding: 2rem;
            color: #6c757d;
        }
        
        .empty-transactions i {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
    </style>
</head>

<body id="category">

	<!-- Start Header Area -->
	<header class="header_area sticky-header">
		<div class="main_menu">
			<nav class="navbar navbar-expand-lg navbar-light main_box">
				<div class="container">
					<!-- Brand and toggle get grouped for better mobile display -->
					<a class="navbar-brand logo_h d-flex align-items-center" href="{% url 'home' %}">
						<img src="{% static 'img/logo2.png' %}" alt="Baka Store Logo" style="height: 4rem; width: 4rem; margin-right: 0.5rem;">
						<p class="brand-text" style="font-size: 1.5rem; font-weight: bold; color: #333; margin: 0;">Baka Store</p>
					</a>
					
					<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
					 aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<!-- Collect the nav links, forms, and other content for toggling -->
					<div class="collapse navbar-collapse offset" id="navbarSupportedContent">
						<ul class="nav navbar-nav menu_nav ml-auto">
							<li class="nav-item"><a class="nav-link" href="{% url 'home' %}">Home</a></li>
							<li class="nav-item submenu dropdown">
								<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
								 aria-expanded="false">Shop</a>
								<ul class="dropdown-menu">
									<li class="nav-item"><a class="nav-link" href="{% url 'category' %}">All Action Figures</a></li>
									<li class="nav-item"><a class="nav-link" href="#">New Arivals</a></li>
									<li class="nav-item"><a class="nav-link" href="#">Best Sellers</a></li>
									<li class="nav-item"><a class="nav-link" href="#">On Sale</a></li>
								</ul>
							</li>
							<li class="nav-item submenu dropdown">
								<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
								 aria-expanded="false">Character Types</a>
								<ul class="dropdown-menu">
									<li class="nav-item"><a class="nav-link" href="#">Heroes</a></li>
									<li class="nav-item"><a class="nav-link" href="#">Villains</a></li>
									<li class="nav-item"><a class="nav-link" href="#">Sidekicks</a></li>
									<li class="nav-item"><a class="nav-link" href="#">Monsters</a></li>
								</ul>
							</li>
							<li class="nav-item submenu dropdown active">
								<a href="#" class="nav-link dropdown-toggle " data-toggle="dropdown" role="button" aria-haspopup="true"
								 aria-expanded="false">Account</a>
								<ul class="dropdown-menu">
									{% if user.is_authenticated %}
            							<li class="nav-item">
                							<a class="nav-link" href="{% url 'user-logout' %}">Logout</a>
            							</li>
										<li class="nav-item">
                							<a class="nav-link" href="#">Wishlist</a>
            							</li>
										<li class="nav-item">
                							<a class="nav-link" href="{% url 'account_details' %}">Account Settings</a>
            							</li>
       	 							{% else %}
            							<li class="nav-item">
                							<a class="nav-link" href="{% url 'user-login' %}">Login</a>
           	 							</li>
        							{% endif %}
								</ul>
							</li>
							<li class="nav-item"><a class="nav-link" href="#">Contact</a></li>
						</ul>
						<ul class="nav navbar-nav navbar-right">
							<li class="nav-item active"><a href="{% url 'cart' %}" class="cart"><span class="ti-bag"></span></a></li>
							<li class="nav-item">
								<button class="search"><span class="lnr lnr-magnifier" id="search"></span></button>
							</li>
						</ul>
					</div>
				</div>
			</nav>
		</div>
		<div class="search_input" id="search_input_box">
			<div class="container">
				<form class="d-flex justify-content-between" action="{% url 'category' %}" method="GET">
					<input type="text" class="form-control" id="search_input" name="search" 
						   placeholder="Search Here" value="{{ search_query|default:'' }}">
					<button type="submit" class="btn"></button>
					<span class="lnr lnr-cross" id="close_search" title="Close Search"></span>
				</form>
			</div>
		</div>
	</header>
	<!-- End Header Area -->

	<!-- Start Banner Area -->
	<section class="banner-area organic-breadcrumb">
        <div class="container">
            <div class="breadcrumb-banner d-flex flex-wrap align-items-center justify-content-end">
                <div class="col-first">
                    <h1>Account Details</h1>
                    <nav class="d-flex align-items-center">
                        <a href="{% url 'home' %}">Home<span class="lnr lnr-arrow-right"></span></a>
                        <a href="{% url 'account_details' %}">Account</a>
                    </nav>
                </div>
            </div>
        </div>
    </section>
	<!-- End Banner Area -->
	<section class="otaku-profile-area">
        <div class="container">
            <div class="row">
                <!-- Anime-inspired Sidebar -->
                <div class="col-lg-3">
                    <div class="otaku-menu">
                        <div class="menu-header">
                            <img src="{% static 'img/logo2.png' %}" alt="Baka Store Logo" class="menu-logo">
                            <h3>Otaku Command Center</h3>
                        </div>
                        <ul class="otaku-nav">
                            <li><a href="{% url 'account_details' %}"><span class="icon">&#x1F464;</span> My Profile</a></li>
                            <li><a href="{% url 'order_history' %}"><span class="icon">&#x1F4C5;</span> Order History</a></li>
                            <li><a href="{% url 'wishlist' %}"><span class="icon">&#x2764;&#xFE0F;</span> Wishlist</a></li>
                            <li class="active"><a href="#"><span class="icon">&#x1F4B0;</span> Wallet</a></li>
                            <li><a href="{% url 'user-logout' %}"><span class="icon">&#x1F6AA;</span> Logout</a></li>
                        </ul>
                    </div>
                </div>
                
                <!-- Main Content Area -->
                <div class="col-lg-9">
                    <div class="wallet-dashboard card shadow">
                        <div class="card-body">
                            <div class="wallet-header">
                                <h2 class="card-title">My Wallet</h2>
                                <div class="wallet-balance">
                                    <span class="balance-label">Current Balance</span>
                                    <span class="balance-amount" id="current-balance">₹{{ wallet.balance }}</span>
                                </div>
                            </div>
                            
                            <div class="wallet-actions row mt-4">
                                <div class="col-md-6 mb-3">
                                    <div class="action-card add-funds card h-100">
                                        <div class="card-body">
                                            <h3 class="card-title">Add Funds</h3>
                                            <form id="add-funds-form">
                                                {% csrf_token %}
                                                <div class="input-group mb-3">
                                                    <span class="input-group-text">₹</span>
                                                    <input type="number" name="amount" min="1" class="form-control" placeholder="Enter amount" required>
                                                </div>
                                                <button type="submit" class="btn btn-primary btn-block">Add Funds</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <div class="action-card withdraw-funds card h-100">
                                        <div class="card-body">
                                            <h3 class="card-title">Withdraw Funds</h3>
                                            <form id="withdraw-funds-form">
                                                {% csrf_token %}
                                                <div class="input-group mb-3">
                                                    <span class="input-group-text">₹</span>
                                                    <input type="number" name="amount" min="1" class="form-control" placeholder="Enter amount" required>
                                                </div>
                                                <button type="submit" class="btn btn-secondary btn-block">Withdraw</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="transaction-history mt-4">
                                <h3 class="mb-3">Transaction History</h3>
                                <div class="transaction-list" id="transaction-list">
                                    {% include 'Users/transaction-list.html' %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
	<!-- start footer Area -->
	<footer class="footer-area section_gap">
		<div class="container">
			<div class="row">
				<div class="col-lg">
					<div class="single-footer-widget about-us-widget">
						<h6>About Us</h6>
						<p>
							Welcome to Baka Store, your ultimate destination for anime action figures. We are passionate about bringing your favorite characters to life with high-quality figures. Our mission is to provide anime enthusiasts with a wide variety of collectibles, ensuring that every fan can find something they love. At Baka Store, we are committed to delivering exceptional products and customer service. Join us in celebrating the world of anime!
						</p>
					</div>
				</div>
			</div>
			<div class="footer-bottom d-flex justify-content-center align-items-center flex-wrap">
				<p class="footer-text m-0">
					Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | Baka Store
				</p>
			</div>
			
		</div>
	</footer>
	<!-- End footer Area -->
	<script src="{% static 'js/vendor/jquery-2.2.4.min.js' %}"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
	 crossorigin="anonymous"></script>
	<script src="{% static 'js/vendor/bootstrap.min.js' %}"></script>
	<script src="{% static 'js/jquery.ajaxchimp.min.js' %}"></script>
	<script src="{% static 'js/jquery.nice-select.min.js' %}"></script>
	<script src="{% static 'js/jquery.sticky.js' %}"></script>
	<script src="{% static 'js/nouislider.min.js' %}"></script>
	<script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
	<script src="{% static 'js/owl.carousel.min.js' %}"></script>
	<!--gmaps Js-->
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE"></script>
	<script src="{% static 'js/gmaps.min.js' %}"></script>
	<script src="{% static 'js/main.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.all.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const addFundForm = document.getElementById('add-funds-form');
            const withdrawFundForm = document.getElementById('withdraw-funds-form');
            const transactionList = document.getElementById('transaction-list');
            const currentBalance = document.getElementById('current-balance');
        
            function updateWallet(url, form, actionType) {
                const formData = new FormData(form);
                const amount = formData.get('amount');
        
                // Custom confirmation based on action type
                let confirmationConfig;
                if (actionType === 'add') {
                    confirmationConfig = {
                        title: 'Add Funds',
                        text: `Are you sure you want to add ₹${amount} to your wallet?`,
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes, add it!',
                        cancelButtonText: 'No, cancel',
                        background: '#f8f9fa',
                        backdrop: `
                            rgba(0,0,123,0.4)
                            url("/path/to/money-rain.gif")
                            left top
                            no-repeat
                        `
                    };
                } else {
                    confirmationConfig = {
                        title: 'Withdraw Funds',
                        text: `Are you sure you want to withdraw ₹${amount} from your wallet?`,
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes, withdraw it!',
                        cancelButtonText: 'No, cancel',
                        background: '#f8f9fa',
                        backdrop: `
                            rgba(123,0,0,0.4)
                            url("/path/to/piggy-bank.gif")
                            right bottom
                            no-repeat
                        `
                    };
                }
        
                Swal.fire(confirmationConfig).then((result) => {
                    if (result.isConfirmed) {
                        // Show loading indicator
                        Swal.fire({
                            title: 'Processing...',
                            text: 'Please wait while we process your transaction.',
                            allowOutsideClick: false,
                            showConfirmButton: false,
                            willOpen: () => {
                                Swal.showLoading();
                            }
                        });
        
                        fetch(url, {
                            method: 'POST',
                            body: formData,
                            headers: {
                                'X-Requested-With': 'XMLHttpRequest',
                            }
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                currentBalance.textContent = '₹' + data.new_balance;
                                transactionList.innerHTML = data.transaction_list;
                                form.reset();
                                showSweetAlert(data.message, 'success');
                            } else {
                                showSweetAlert(data.message, 'error');
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            showSweetAlert('An error occurred. Please try again.', 'error');
                        });
                    }
                });
            }
        
            function showSweetAlert(message, type) {
                Swal.fire({
                    icon: type,
                    title: type === 'success' ? 'Success!' : 'Error!',
                    text: message,
                    timer: 3000,
                    timerProgressBar: true
                });
            }
        
            addFundForm.addEventListener('submit', function(e) {
                e.preventDefault();
                updateWallet('/Wallet/wallet/add-funds/', this, 'add');
            });
        
            withdrawFundForm.addEventListener('submit', function(e) {
                e.preventDefault();
                updateWallet('/Wallet/wallet/withdraw-funds/', this, 'withdraw');
            });
        });
    </script>
</body>

</html>